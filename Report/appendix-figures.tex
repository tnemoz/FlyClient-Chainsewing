\begin{figure}[ht]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \centering 
        \begin{tikzpicture}
            \begin{axis}[enlargelimits=false,
                axis on top,
                tick label style={major tick length=0pt},
                colorbar,
                colorbar style={
                    title=\(p_{\text{success}}\),
                    yticklabel style={
                        /pgf/number format/.cd,
                            fixed,
                            % fixed zerofill,
                            precision=3,
                    }
                },
                % xtick distance=5,
                point meta max=1,
                point meta min=0.85,
                xmin=0,
                xmax=13,
                ymin=2,
                ymax=51,
                xlabel=\(\overline{F}\),
                ylabel=\(n - m\),
                extra y ticks={2},
                width=.85\textwidth
            ]
            \addplot[matrix plot,
            point meta=explicit,
            ] file {
            data/first_setup_appendix/first_setup_heatmap_50.txt
            };
            \end{axis}
        \end{tikzpicture}
        \caption{Probability of success for \(\mu=50\%\)}
    \end{subfigure}
    ~
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[enlargelimits=false,
                axis on top,
                tick label style={major tick length=0pt},
                colorbar,
                colorbar style={
                    title=\(p_{\text{success}}\),
                    yticklabel style={
                        /pgf/number format/.cd,
                            fixed,
                            % fixed zerofill,
                            precision=3,
                    }
                },
                % xtick distance=5,
                point meta max=1,
                point meta min=0.795,
                xmin=0,
                xmax=32,
                ymin=2,
                ymax=51,
                xlabel=\(\overline{F}\),
                ylabel=\(n - m\),
                extra y ticks={2},
                width=.85\textwidth
            ]
            \addplot[matrix plot,
            point meta=explicit,
            ] file {
            data/first_setup_appendix/first_setup_heatmap_25.txt
            };
            \end{axis}
        \end{tikzpicture}
        \caption{Probability of success for \(\mu=25\%\)}
    \end{subfigure}

    \begin{subfigure}[b]{0.45\textwidth}
        \centering 
        \begin{tikzpicture}
            \begin{axis}[enlargelimits=false,
                axis on top,
                tick label style={major tick length=0pt},
                colorbar,
                colorbar style={
                    title=\(p_{\text{success}}\),
                    yticklabel style={
                        /pgf/number format/.cd,
                            fixed,
                            % fixed zerofill,
                            precision=3,
                    }
                },
                % xtick distance=5,
                point meta max=1,
                point meta min=0.70,
                xmin=0,
                xmax=87,
                ymin=2,
                ymax=51,
                xlabel=\(\overline{F}\),
                ylabel=\(n - m\),
                extra y ticks={2},
                width=.85\textwidth
            ]
            \addplot[matrix plot,
            point meta=explicit,
            ] file {
            data/first_setup_appendix/first_setup_heatmap_10.txt
            };
            \end{axis}
        \end{tikzpicture}
        \caption{Probability of success for \(\mu=10\%\)}
    \end{subfigure}
    ~
    \begin{subfigure}[b]{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[enlargelimits=false,
                axis on top,
                tick label style={major tick length=0pt},
                colorbar,
                colorbar style={
                    title=\(p_{\text{success}}\),
                    yticklabel style={
                        /pgf/number format/.cd,
                            fixed,
                            % fixed zerofill,
                            precision=3,
                    }
                },
                % xtick distance=5,
                point meta max=1,
                point meta min=0.40,
                xmin=0,
                xmax=915,
                ymin=2,
                ymax=51,
                xlabel=\(\overline{F}\),
                ylabel=\(n - m\),
                extra y ticks={2},
                width=.85\textwidth
            ]
            \addplot[matrix plot,
            point meta=explicit,
            ] file {
            data/first_setup_appendix/first_setup_heatmap_1.txt
            };
            \end{axis}
        \end{tikzpicture}
        \caption{Probability of success for \(\mu=1\%\)}
    \end{subfigure}
    \caption{Probability of success of the \cs\ attack as a function of \(\overline{F}\) and \(n-m\) for different computational powers \(\mu\) for the direct setup.}
    \label{figure:heatmapsproba}
\end{figure}

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \begin{axis}[grid=major,
            xlabel={\(p_{\text{success}}\)},
            ylabel={Number of blocks},
            legend entries={\(\mu=50\%\), \(\mu=33\%\), \(\mu=25\%\)},
            no marks,
            legend style={at={(0,1)},anchor=north west},
            width=\figurewidth\textwidth
        ]
            \addplot table[x index=0, y index=1]{data/first_setup_appendix/first_setup_final_50.txt};
            \addplot table[x index=0, y index=1]{data/first_setup_appendix/first_setup_final_33.txt};
            \addplot table[x index=0, y index=1]{data/first_setup_appendix/first_setup_final_25.txt};
        \end{axis}
    \end{tikzpicture}
    \caption{Total time (in blocks) between the moment when the adversary began to try to mine the forking block and the moment they ask for transaction inclusion verification as a function of the desired probability of success for different computational powers for the direct setup for \(\delta=2^{-10}\).}
    \label{figure:finalprobafirstsetup}
\end{figure}